<!-- views/users/index.ejs -->

<!--
  Listing 18.8 (p. 268)
  index.jsÏóêÏÑúÏùò Î™®Îì† ÏÇ¨Ïö©Ïûê Î¶¨Ïä§ÌåÖ
-->

<main class="">
  <div class="container col-xl-10 col-xxl-8 px-4 py-5">
    <div class="pt-5 pb-5">
      <h1>Users</h1>
      <p>Here are all the users on our site.</p>

      <table class="table table-striped table-hover">
        <thead>
          <tr>
            <th scope="col">#</th>
            <th scope="col">Pic</th>
            <th>Username</th>
            <th>Full Name</th>
            <th>Email</th>
            <th>Subscribed?</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <% users.forEach(function(user, i) { %>
          <tr>
            <td><%= i+1 %></td>
            <td>
              <a href="/users/<%= user.id %>">
                <figure class="user-img">
                  <img src="<%= user.profileImg ||
                  "https://via.placeholder.com/150" %>" alt="Placeholder image"
                  class="rounded-circle" />
                </figure> </a
              ><!-- HTMLÏóêÏÑú ÏÇ¨Ïö©Ïûê Ïù¥Í∏àÍ≥º ID ÏÇΩÏûÖ -->
            </td>
            <td>
              <a href="/users/<%= user.id %>"><%= user.username %></a
              ><!-- HTMLÏóêÏÑú ÏÇ¨Ïö©Ïûê Ïù¥Í∏àÍ≥º ID ÏÇΩÏûÖ -->
            </td>
            <!-- 
              Listing 19.6 (p. 284)
              name Îç∞Ïù¥ÌÑ∞ ÏóÖÎç∞Ïù¥Ìä∏
            -->
            <td><%= user.fullName %></td>
            <td><%= user.email %></td>
            <% if (user.subscribedAccount) { %>
            <!-- Íµ¨ÎèÖ Í≥ÑÏ†ïÏù¥ ÏûàÎäî Í≤ΩÏö∞ -->
            <td><%= user.subscribedAccount %> ‚úÖ</td>
            <% } else { %>
            <!-- Íµ¨ÎèÖ Í≥ÑÏ†ïÏù¥ ÏóÜÎäî Í≤ΩÏö∞ -->
            <td>‚ùå</td>
            <% } %>
            <td>
              <!-- 
                Listing 20.2 (p. 291)
                ÏÇ¨Ïö©Ïûê Ìé∏ÏßëÏùÑ ÏúÑÌïú ÌÖåÏù¥Î∏î ÏàòÏ†ï
              -->
              <a
                class="btn btn-sm btn-outline-primary"
                role="button"
                href="/users/<%= user._id %>/edit"
                >‚úèÔ∏è Edit</a
              ><!-- ÏÇ¨Ïö©Ïûê IDÎ•º edit ÌÉúÍ∑∏ ÎßÅÌÅ¨Ïóê ÏÇΩÏûÖ -->

              <!-- 
                Listing 20.8 (p. 297) 
                ÏÇ¨Ïö©Ïûê ÏÇ≠Ï†ú ÎßÅÌÅ¨
              -->
              <a
                class="btn btn-sm btn-outline-danger"
                role="button"
                href="/users/<%= user._id %>/delete?_method=DELETE"
                onclick="return confirm('Are you sure you want to delete this record?')"
                >üóëÔ∏è Delete</a
              ><!-- Ïù∏Îç±Ïä§ ÌéòÏù¥ÏßÄÏóêÏÑú delete Ïï°ÏÖòÏúºÎ°úÏùò ÎßÅÌÅ¨ Ï∂îÍ∞Ä -->

              <!--
                ÎÖ∏Ìä∏: onclick="return confirm('Are you sure you want to delete this record?')"Ïùò
                Ï∂îÍ∞ÄÎ°ú Ï¢Ä Îçî ÏïàÏ†ÑÌïú Ïû•ÏπòÎ•º Ï∂îÍ∞ÄÌï† Ïàò ÏûàÎã§.
              -->
            </td>
          </tr>
          <% }); %>
        </tbody>
      </table>

      <div class="mt-5 text-center">
        <a href="/users/new" class="btn btn-primary">Add New User</a>
        <a
          href="/"
          class="btn ut-red disabled"
          role="button"
          aria-disabled="true"
          >Delete All Users</a
        >
        <a
          href="/"
          class="btn btn-secondary disabled"
          role="button"
          aria-disabled="true"
          >Link Subscribers</a
        >
      </div>
    </div>
  </div>
</main>
