<!-- views/users/edit -->

<!--
  Listing 20.1 (p. 290)
  ÏÇ¨Ïö©Ïûê ÏûÖÎ†• Ìèº ÏòàÏ†ú
-->

<main class="user-profile">
  <div class="container col-xl-10 col-xxl-8 px-4 py-5">
    <div class="pt-5">
      <h1>
        User Data for <%= user.fullName %>
        <span class="btn btn-outline-danger">Editing</span>
      </h1>

      <!-- 
        Listing 20.5 (p. 292)
        ÏµúÏ¢Ö ÏÇ¨Ïö©Ïûê Ìé∏Ïßë Ìèº
      -->
      <div class="row">
        <div class="col col-lg-2" style="position: relative">
          <figure class="user-img mt-5 mb-3">
            <img src="<%= user.profileImg || "https://via.placeholder.com/150"
            %>" alt="Placeholder image" class="rounded-circle" />
          </figure>
          <span
            class="btn profileImg-edit-btn btn-outline-danger"
            id="profileImg-edit-button"
            >‚úèÔ∏è</span
          >
          <input
            type="text"
            name="profileImg"
            id="inputProfileImg"
            class="form-control profileImg-edit-input"
            value="<%= user.profileImg %>"
            placeholder="URL for profile image"
          />
        </div>

        <!-- ÏÇ¨Ïö©Ïûê Ìé∏Ïßë Ìèº Ï∂úÎ†• -->
        <div class="col col-lg-10">
          <!-- Listing 20.4 (p. 292) -->
          <!-- ÏÇ¨Ïö©Ïûê Îç∞Ïù¥ÌÑ∞ updateÎ°úÏùò Ìèº Ï∂îÍ∞Ä -->
          <form
            class="user-edit-form mb-3"
            method="POST"
            action="<%= `/users/${user._id}/update?_method=PUT` %>"
          >
            <table class="table table-striped table-hover mt-5 mb-5">
              <!-- ÏÇ¨Ïö©Ïûê Îç∞Ïù¥ÌÑ∞Î•º Î≥¥Ïó¨Ï£ºÍ∏∞ ÏúÑÌïú ÌÖåÏù¥Î∏î Ï∂îÍ∞Ä -->
              <tbody>
                <tr>
                  <th scope="col">Username</th>
                  <td colspan="2" class="pt-0 pb-0 px-0">
                    <input
                      type="text"
                      name="username"
                      id="inputUsername"
                      class="form-control"
                      value="<%= user.username %>"
                      placeholder="Username"
                      autofocus
                    />
                  </td>
                </tr>
                <tr>
                  <th scope="col">Name (first, last)</th>
                  <td class="pt-0 pb-0 px-0">
                    <input
                      type="text"
                      name="first"
                      id="inputFirstName"
                      class="form-control"
                      value="<%= user.name.first %>"
                      placeholder="First name"
                      autofocus
                    />
                  </td>
                  <td class="pt-0 pb-0 px-0">
                    <input
                      type="text"
                      name="last"
                      id="inputLastName"
                      class="form-control"
                      value="<%= user.name.last %>"
                      placeholder="Last name"
                      required
                    />
                  </td>
                </tr>
                <tr>
                  <th scope="col">Email</th>
                  <td colspan="2" class="pt-0 pb-0 px-0">
                    <input
                      type="email"
                      name="email"
                      id="inputEmail"
                      class="form-control"
                      value="<%= user.email %>"
                      placeholder="Email address"
                      required
                    />
                  </td>
                </tr>
                <tr>
                  <th scope="col">Password (+ Confirm)</th>
                  <td class="pt-0 pb-0 px-0">
                    <input
                      type="password"
                      name="password"
                      id="inputPassword"
                      class="form-control"
                      value=""
                      placeholder="Password"
                    />
                  </td>
                  <td class="pt-0 pb-0 px-0">
                    <input
                      type="password"
                      name="password2"
                      id="inputPassword2"
                      class="form-control"
                      value=""
                      placeholder="Confirm password"
                    />
                  </td>
                </tr>
                <tr>
                  <th scope="col">Courses</th>
                  <td colspan="2"><%= user.courses %></td>
                </tr>
                <tr>
                  <th scope="col">Subscribed Account</th>
                  <td colspan="2">
                    <label>
                      <input type="checkbox" value="subscribe" checked />
                      Subscribed to Newsletter
                    </label>
                  </td>
                </tr>
                <tr>
                  <th scope="col">Created</th>
                  <td colspan="2"><%= user.createdAt %></td>
                </tr>
                <tr>
                  <th scope="col">Updated</th>
                  <td colspan="2"><%= user.updatedAt %></td>
                </tr>
                <tr>
                  <th scope="col">ID</th>
                  <td colspan="2"><%= user._id %></td>
                </tr>
                <!-- <tr class="profileImg-row">
                  <th scope="col">Profile Picture</th>
                  <td colspan="2" class="pt-0 pb-0 px-0">
                    <input
                      type="text"
                      name="profileImg"
                      id="inputProfileImg"
                      class="form-control"
                      value="<%= // user.profileImg %>"
                      placeholder="URL for profile image"
                    />
                  </td>
                </tr> -->
              </tbody>
            </table>
            <button type="submit" class="btn btn-info">üíæ Update User</button>
            <a href="/users/<%= user._id %>" class="btn btn-danger"
              >‚ùå Cancel</a
            >
          </form>
        </div>
      </div>

      <!-- Íµ¨ÎèÖÏûê Í≥ÑÏ†ï ÌôïÏù∏ -->
      <% if (user.subscribedAccount) { %>
      <h4 class="mt-5 text-center">
        This user has a subscribed account:
        <a href="/subscribers/<%= user.subscribedAccount %>">
          <%= user.subscribedAccount.name %> </a
        >.
      </h4>
      <% } %>

      <!--
        ÎÖ∏Ìä∏: ÎßÅÌÅ¨Îêú Íµ¨ÎèÖÏûê ÌéòÏù¥ÏßÄÍ∞Ä Ï†úÎåÄÎ°ú ÎèôÏûëÌïòÎ†§Î©¥ Ïù¥Îü∞ Í≥ºÏ†ïÏùÑ Íµ¨ÎèÖÏûêÎ•º ÏúÑÌïú CRUD Ìï®Ïàò Î∞è
        Î∑∞Ïùò ÏÉùÏÑ±ÏóêÏÑúÎèÑ ÎèôÏãúÏóê Îî∞ÎùºÏïº Ìï† Í≤ÉÏù¥Îã§. Href ÏïµÏª§ ÌÉúÍ∑∏Ïù∏ /subscribers/${user.susbcribedAccount}Îäî
        Íµ¨ÎèÖÏûêÏùò show ÌéòÏù¥ÏßÄÎ•º ÎÇòÌÉÄÎÇ∏Îã§.
      -->

      <!--
        Listing 20.10 (p. 299)
        CRUD Ïï°ÏÖòÏùÑ ÏúÑÌïú ÎßÅÌÅ¨ Ï∂îÍ∞Ä
      -->
      <div class="row">
        <div class="col col-lg-10 offset-lg-2">
          <!-- ÌîÑÎ°úÌïÑ ÌéòÏù¥ÏßÄÏóêÏÑú ÏÇ¨Ïö©Ïûê Í≥ÑÏ†ïÏùò Ìé∏Ïßë Î∞è ÏÇ≠Ï†úÎ•º ÏúÑÌïú ÎßÅÌÅ¨ Ï∂îÍ∞Ä -->
          <a href="/users" class="btn btn-primary">‚Üê Back to Users</a>
          <a
            href="/users/<%= user._id %>/delete?_method=DELETE"
            onclick="return confirm('Are you sure you want to delete this record?')"
            class="btn btn-danger"
            role="button"
            >üóëÔ∏è Delete User</a
          >
        </div>
      </div>
    </div>
  </div>
</main>
